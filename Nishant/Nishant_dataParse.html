<html>
<head>
<title>HTML/JS/D3 -> R</title>
<script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
<svg />
<script>

/** 
  Recreate the following steps in R using dplyr and ggplot.
  Look at the comments for names that may suggest interesting functions.
  Your R code should be much shorter.
  */

var years = [1800,1810,1820,1830,1840,1850,1860,1870,1880,1890,1900,1910,1920,1930,1940,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015];
var population = {};
var fertility = {};

function mutateRow(row) {
  return row;
}



function callback(error, pop_data, fertility_data) {
  var dict = {}; // {Year, {Country, {Latitude, Longitude, Population Size, Color}}}
  pop_data.forEach(function(element) {
    tmp = {}
    for(year in years) {
      if (years[year] >= 1950){
        arr1 = [];
        arr1.push(element[years[year]]);
        tmp[years[year]] = arr1;
        }
        dict[element["Country"]] = tmp;
      }
  });  
  population = dict;

  var dict2 = {}; // {Year, {Country, {Latitude, Longitude, Population Size, Color}}}
  fertility_data.forEach(function(element) {
    tmp2 = {}
    for(year in years) {
      if (years[year] >= 1950){
        arr2 = [];
        arr2.push(element[years[year]]);
        tmp2[years[year]] = arr2;
        }
        dict2[element["Country"]] = tmp2;
      }
  });  
  fertility = dict2;

}

//buildScatterPlot(population, fertility)

function buildScatterPlot(error,population,fertility){
  var yearExtent = d3.extent(years);
  //console.log(yearExtent);
  yearScale = d3.scaleLinear()
  .domain(yearExtent)
  .range([0, 400]);

  var popExtent = d3.extent(population, function(d){
    return d.element[years[year]];
  console.log(popExtent);
  })

    
}


d3.queue()
.defer(d3.csv, "indicator_gapminder_population.csv")
.defer(d3.csv, "gapminder_children_per_woman_data.csv")
.await(callback);
 
</script>
</body>
</html>